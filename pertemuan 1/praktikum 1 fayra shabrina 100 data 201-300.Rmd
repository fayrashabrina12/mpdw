---
title: "mpdwww"
author: "Fayra Shabrina"
date: "2025-08-31"
output: html_document
---

```{r}
library("readxl")
library("forecast")
library("graphics")
library("TTR")
library("TSA")
```

```{r}
library(rio)
data_mpdw <- import("https://raw.githubusercontent.com/nyayunabila/mpdw/refs/heads/main/Pertemuan%201/data-kelompok-9-mpdw.csv")
```

```{r}
data_201to300 <- data_mpdw[201:300, ]
data_201to300
```

## Eksplorasi Data

```{r}
str(data_201to300)
dim(data_201to300)
```

### Mengubah ke deret waktu

```{r}
ts_data <- ts(data_201to300$daily_revenue)
```

Menampilkan ringkasan data

```{r}
summary(ts_data)
```

Membuat plot data deret waktu

```{r}
ts.plot(ts_data, xlab="Time Period ", ylab="daily_average", 
        main = "Time Series Plot")
points(ts_data)
```

Cek ADF

```{r}
library(tseries)

# Augmented Dickey-Fuller Test
adf.test(ts_data)

# KPSS Test
kpss.test(ts_data)
```

## Single Moving Average & Double Moving Average

### Pembagian Data

Pembagian data latih dan data uji dilakukan dengan perbandingan 80% data latih dan 20% data uji.

```{r}
#membagi data latih dan data uji
training_m <- data_201to300[1:80,]
testing_m <- data_201to300[81:100,]
train_m.ts <- ts(training_m$`daily_revenue`)
test_m.ts <- ts(testing_m$`daily_revenue`)
```

### Eksplorasi Data

```{r}
#eksplorasi keseluruhan data
plot(ts_data, col="red",main="Plot semua data")
points(ts_data)

#eksplorasi data latih
plot(train_m.ts, col="blue",main="Plot data latih")
points(train_m.ts)

#eksplorasi data uji
plot(test_m.ts, col="blue",main="Plot data uji")
points(test_m.ts)
```

### Single Moving Average (SMA)

```{r}
data.SMA<-SMA(train_m.ts, n=4)
data.SMA
```

Data pemulusan pada periode ke-t selanjutnya digunakan sebagai nilai peramalan pada periode ke t+1 sehingga hasil peramalan 1 periode kedepan adalah sebagai berikut.

```{r}
data.ramal<-c(NA,data.SMA)
data.ramal #forecast 1 periode ke depan
```

Selanjutnya akan dilakukan peramalan sejumlah data uji yaitu 20 periode. Pada metode SMA, hasil peramalan 20 periode ke depan akan bernilai sama dengan hasil peramalan 1 periode kedepan. Dalam hal ini akan dilakukan pengguabungan data aktual train, data hasil pemulusan dan data hasil ramalan 20 periode kedepan.

```{r}
data.gab<-cbind(aktual=c(train_m.ts,rep(NA,20)),pemulusan=c(data.SMA,rep(NA,20)),ramalan=c(data.ramal,rep(data.ramal[length(data.ramal)],19)))
data.gab #forecast 20 periode ke depan
```

Plot data deret waktu dari hasil peramalan yang dilakukan adalah sebagai berikut.

```{r}
ts.plot(ts_data, xlab="date ", ylab="daily_revenue", main= "SM N=4 Data daily revenue")
points(ts_data)
lines(data.gab[,2],col="green",lwd=2)
lines(data.gab[,3],col="red",lwd=2)
legend("topleft",c("data aktual","data pemulusan","data peramalan"), lty=8, col=c("black","green","red"), cex=0.5)
```

perhitungan akurasi dilakukan dengan ukuran akurasi *Sum Squares Error* (SSE), *Mean Square Error* (MSE) dan *Mean Absolute Percentage Error* (MAPE). Perhitungan akurasi dilakukan baik pada data latih maupun pada data uji.

```{r}
#Menghitung nilai keakuratan data latih
error_train.sma = train_m.ts-data.ramal[1:length(train_m.ts)]
SSE_train.sma = sum(error_train.sma[5:length(train_m.ts)]^2)
MSE_train.sma = mean(error_train.sma[5:length(train_m.ts)]^2)
MAPE_train.sma = mean(abs((error_train.sma[5:length(train_m.ts)]/train_m.ts[5:length(train_m.ts)])*100))

akurasi_train.sma <- matrix(c(SSE_train.sma, MSE_train.sma, MAPE_train.sma))
row.names(akurasi_train.sma)<- c("SSE", "MSE", "MAPE")
colnames(akurasi_train.sma) <- c("Akurasi m = 4")
akurasi_train.sma
```

Dalam hal ini nilai MAPE data latih pada metode pemulusan SMA lebih dari 50%, nilai ini dapat dikategorikan sebagai nilai akurasi yang buruk. Selanjutnya dilakukan perhitungan nilai MAPE data uji pada metode pemulusan SMA.

```{r}
#Menghitung nilai keakuratan data uji
error_test.sma = test_m.ts-data.gab[81:100,3]
SSE_test.sma = sum(error_test.sma^2)
MSE_test.sma = mean(error_test.sma^2)
MAPE_test.sma = mean(abs((error_test.sma/test_m.ts*100)))

akurasi_test.sma <- matrix(c(SSE_test.sma, MSE_test.sma, MAPE_test.sma))
row.names(akurasi_test.sma)<- c("SSE", "MSE", "MAPE")
colnames(akurasi_test.sma) <- c("Akurasi m = 4")
akurasi_test.sma
```

### Double Moving Average (DMA)

```{r}
dma <- SMA(data.SMA, n = 4)
At <- 2*data.SMA - dma
Bt <- 2/(4-1)*(data.SMA - dma)
data.dma<- At+Bt
data.ramal2<- c(NA, data.dma)

t = 1:20
f = c()

for (i in t) {
  f[i] = At[length(At)] + Bt[length(Bt)]*(i)
}

data.gab2 <- cbind(aktual = c(train_m.ts,rep(NA,20)), pemulusan1 = c(data.SMA,rep(NA,20)),pemulusan2 = c(data.dma, rep(NA,20)),At = c(At, rep(NA,20)), Bt = c(Bt,rep(NA,20)),ramalan = c(data.ramal2, f[-1]))
data.gab2

```

Hasil pemulusan menggunakan metode DMA divisualisasikan sebagai berikut

```{r}
ts.plot(ts_data, xlab="date", ylab="Daily Revenue", main= "DMA N=4 Data daily revenue")
points(ts_data)
lines(data.gab2[,3],col="green",lwd=2)
lines(data.gab2[,6],col="red",lwd=2)
legend("topleft",c("data aktual","data pemulusan","data peramalan"), lty=8, col=c("black","green","red"), cex=0.8)
```

perhitungan akurasi dilakukan baik pada data latih maupun data uji. Perhitungan akurasi dilakukan dengan ukuran akurasi SSE, MSE dan MAPE.

```{r}
#Menghitung nilai keakuratan data latih
error_train.dma = train_m.ts-data.ramal2[1:length(train_m.ts)]
SSE_train.dma = sum(error_train.dma[8:length(train_m.ts)]^2)
MSE_train.dma = mean(error_train.dma[8:length(train_m.ts)]^2)
MAPE_train.dma = mean(abs((error_train.dma[8:length(train_m.ts)]/train_m.ts[8:length(train_m.ts)])*100))

akurasi_train.dma <- matrix(c(SSE_train.dma, MSE_train.dma, MAPE_train.dma))
row.names(akurasi_train.dma)<- c("SSE", "MSE", "MAPE")
colnames(akurasi_train.dma) <- c("Akurasi m = 4")
akurasi_train.dma
```

Perhitungan akurasi pada data latih menggunakan nilai MAPE menghasilkan nilai MAPE yang lebih dari 50% sehingga dikategorikan buruk.

perhitungan nilai akurasi dilakukan pada data uji.

```{r}
#Menghitung nilai keakuratan data uji
error_test.dma = test_m.ts-data.gab2[81:100,6]
SSE_test.dma = sum(error_test.dma^2)
MSE_test.dma = mean(error_test.dma^2)
MAPE_test.dma = mean(abs((error_test.dma/test_m.ts*100)))

akurasi_test.dma <- matrix(c(SSE_test.dma, MSE_test.dma, MAPE_test.dma))
row.names(akurasi_test.dma)<- c("SSE", "MSE", "MAPE")
colnames(akurasi_test.dma) <- c("Akurasi m = 4")
akurasi_test.dma
```

Perhitungan akurasi menggunakan data latih menghasilkan nilai MAPE yang kurang dari 50% sehingga nilai akurasi ini dapat dikategorikan sebagai buruk.

Pada data latih dan data uji, metode SMA lebih baik dibandingkan dengan metode DMA

## Single Exponential Smoothing & Double Exponential Smoothing

### Pembagian Data

Pembagian data latih dan data uji dilakukan dengan perbandingan 80% data latih dan 20% data uji.

```{r}
#membagi training dan testing
trainingg <-data_201to300[1:80,]
testingg <-data_201to300[81:100,]
traints <- ts(trainingg$`daily_revenue`)
testts <- ts(testingg$`daily_revenue`)
```

### Eksplorasi

Eksplorasi dilakukan dengan membuat plot data deret waktu untuk keseluruhan data, data latih, dan data uji.

```{r}
#eksplorasi data
plot(ts_data, col="black",main="Plot semua data")
points(ts_data)

plot(traints, col="red",main="Plot data latih")
points(traints)

plot(testts, col="blue",main="Plot data uji")
points(testts)
```

###SES

```{r}
#Cara 1 (fungsi ses)
ses.satu <- ses(traints, h = 10, alpha = 0.2)
plot(ses.satu)
ses.satu

ses.dua <- ses(traints, h = 10, alpha = 0.7)
plot(ses.dua)
ses.dua
```

```{r}
#Cara 2 (fungsi Holtwinter)
ses.satu<- HoltWinters(traints, gamma = FALSE, beta = FALSE, alpha = 0.2)
plot(ses.satu)

#ramalan
ramalansatu<- forecast(ses.satu, h=10)
ramalansatu

ses.dua<- HoltWinters(traints, gamma = FALSE, beta = FALSE, alpha = 0.7)
plot(ses.dua)

#ramalan
ramalandua<- forecast(ses.dua, h=10)
ramalandua
```

```{r}
#SES
ses.opt <- ses(traints, h = 10, alpha = NULL)
plot(ses.opt)
ses.opt

#Lamda Optimum Holt Winter
sesopt<- HoltWinters(traints, gamma = FALSE, beta = FALSE,alpha = NULL)
sesopt
plot(sesopt)

#ramalan
ramalanopt<- forecast(sesopt, h=10)
ramalanopt
```

#### Akurasi Data Latih

```{r}
#Keakuratan Metode
#Pada data training
SSE1<-ses.satu$SSE
MSE1<-ses.satu$SSE/length(traints)
RMSE1<-sqrt(MSE1)

akurasi1 <- matrix(c(SSE1,MSE1,RMSE1))
row.names(akurasi1)<- c("SSE", "MSE", "RMSE")
colnames(akurasi1) <- c("Akurasi lamda=0.2")
akurasi1

SSE2<-ses.dua$SSE
MSE2<-ses.dua$SSE/length(traints)
RMSE2<-sqrt(MSE2)

akurasi2 <- matrix(c(SSE2,MSE2,RMSE2))
row.names(akurasi2)<- c("SSE", "MSE", "RMSE")
colnames(akurasi2) <- c("Akurasi lamda=0.7")
akurasi2

#Cara Manual
fitted1<-ramalansatu$fitted
sisaan1<-ramalansatu$residuals
head(sisaan1)

resid1<-trainingg$daily_revenue-ramalansatu$fitted
head(resid1)
```

```{r}
#Cara Manual
SSE.1=sum(sisaan1[2:length(traints)]^2)
SSE.1

MSE.1 = SSE.1/length(traints)
MSE.1

MAPE.1 = sum(abs(sisaan1[2:length(traints)]/traints[2:length(traints)])*
               100)/length(traints)
MAPE.1

akurasi.1 <- matrix(c(SSE.1,MSE.1,MAPE.1))
row.names(akurasi.1)<- c("SSE", "MSE", "MAPE")
colnames(akurasi.1) <- c("Akurasi lamda=0.2")
akurasi.1

fitted2<-ramalandua$fitted
sisaan2<-ramalandua$residuals
head(sisaan2)

resid2<-trainingg$daily_revenue-ramalandua$fitted
head(resid2)

SSE.2=sum(sisaan2[2:length(traints)]^2)
SSE.2

MSE.2 = SSE.2/length(traints)
MSE.2

MAPE.2 = sum(abs(sisaan2[2:length(traints)]/traints[2:length(traints)])*
               100)/length(traints)
MAPE.2

akurasi.2 <- matrix(c(SSE.2,MSE.2,MAPE.2))
row.names(akurasi.2)<- c("SSE", "MSE", "MAPE")
colnames(akurasi.2) <- c("Akurasi lamda=0.7")
akurasi.2
```

Berdasarkan nilai SSE, MSE, RMSE, dan MAPE di antara kedua parameter, nilai parameter $\lambda=0,2$ menghasilkan akurasi yang lebih baik dibanding $\lambda=0,7$ . Hal ini dilihat dari nilai masing-masing ukuran akurasi yang lebih kecil.Berdasarkan nilai MAPE-nya, hasil ini dapat dikategorikan sebagai peramalan yang buruk.

### DES

```{r}
#Lamda=0.2 dan gamma=0.2
des.1<- HoltWinters(traints, gamma = FALSE, beta = 0.2, alpha = 0.2)
plot(des.1)

#ramalan
ramalandes1<- forecast(des.1, h=10)
ramalandes1

#Lamda=0.6 dan gamma=0.3
des.2<- HoltWinters(traints, gamma = FALSE, beta = 0.3, alpha = 0.6)
plot(des.2)

#ramalan
ramalandes2<- forecast(des.2, h=10)
ramalandes2
```

membandingkan plot data latih dan data uji adalah sebagai berikut.

```{r}
#Visually evaluate the prediction
plot(ts_data)
lines(des.1$fitted[,1], lty=2, col="blue")
lines(ramalandes1$mean, col="red")
```

mendapatkan nilai parameter optimum dari DES, argumen `alpha` dan `beta` dapat dibuat `NULL` seperti berikut.

```{r}
#Lamda dan gamma optimum
des.opt<- HoltWinters(traints, gamma = FALSE)
des.opt
plot(des.opt)

#ramalan
ramalandesopt<- forecast(des.opt, h=10)
ramalandesopt
```

perhitungan akurasi pada data latih maupun data uji dengan ukuran akurasi SSE, MSE dan MAPE.

#### Akurasi Data Latih

```{r}
#Akurasi Data Training
ssedes.train1<-des.1$SSE
msedes.train1<-ssedes.train1/length(traints)
sisaandes1<-ramalandes1$residuals
head(sisaandes1)

mapedes.train1 <- sum(abs(sisaandes1[3:length(traints)]/traints[3:length(traints)])
                      *100)/length(traints)

akurasides.1 <- matrix(c(ssedes.train1,msedes.train1,mapedes.train1))
row.names(akurasides.1)<- c("SSE", "MSE", "MAPE")
colnames(akurasides.1) <- c("Akurasi lamda=0.2 dan gamma=0.2")
akurasides.1

ssedes.train2<-des.2$SSE
msedes.train2<-ssedes.train2/length(traints)
sisaandes2<-ramalandes2$residuals
head(sisaandes2)

mapedes.train2 <- sum(abs(sisaandes2[3:length(traints)]/traints[3:length(traints)])
                      *100)/length(traints)

akurasides.2 <- matrix(c(ssedes.train2,msedes.train2,mapedes.train2))
row.names(akurasides.2)<- c("SSE", "MSE", "MAPE")
colnames(akurasides.2) <- c("Akurasi lamda=0.6 dan gamma=0.3")
akurasides.2
```

Hasil akurasi dari data latih didapatkan skenario 2 dengan lamda=0.2 dan gamma=0.2 memiliki hasil yang lebih baik. Namun untuk kedua skenario dapat dikategorikan peramalan buruk berdasarkan nilai MAPE-nya.

#### Akurasi Data Uji

```{r}
#Akurasi Data Testing
n_forecast <- length(ramalandes1$mean)
n_test     <- length(testingg$daily_revenue)

n <- min(n_forecast, n_test)  # ambil panjang terpendek

selisihdes1 <- as.numeric(ramalandes1$mean[1:n]) - as.numeric(testingg$daily_revenue[1:n])
selisihdes1


SSEtestingdes1<-sum(selisihdes1^2)
MSEtestingdes1<-SSEtestingdes1/length(testingg$daily_revenue)
MAPEtestingdes1<-sum(abs(selisihdes1/testingg$daily_revenue)*100)/length(testingg$daily_revenue)

n_forecast2 <- length(ramalandes2$mean)
n_test2     <- length(testingg$daily_revenue)

n2 <- min(n_forecast2, n_test2)

selisihdes2 <- as.numeric(ramalandes2$mean[1:n2]) - as.numeric(testingg$daily_revenue[1:n2])
selisihdes2

SSEtestingdes2 <- sum(selisihdes2^2)
MSEtestingdes2 <- SSEtestingdes2 / n2
MAPEtestingdes2 <- sum(abs(selisihdes2 / testingg$daily_revenue[1:n2]) * 100) / n2

n_forecast_opt <- length(ramalandesopt$mean)
n_test_opt     <- length(testingg$daily_revenue)

n_opt <- min(n_forecast_opt, n_test_opt)

selisihdesopt <- as.numeric(ramalandesopt$mean[1:n_opt]) - as.numeric(testingg$daily_revenue[1:n_opt])
selisihdesopt

SSEtestingdesopt <- sum(selisihdesopt^2)
MSEtestingdesopt <- SSEtestingdesopt / n_opt
MAPEtestingdesopt <- sum(abs(selisihdesopt / testingg$daily_revenue[1:n_opt]) * 100) / n_opt

akurasitestingdes <-
  matrix(c(SSEtestingdes1,MSEtestingdes1,MAPEtestingdes1,SSEtestingdes2,MSEtestingdes2,
           MAPEtestingdes2,SSEtestingdesopt,MSEtestingdesopt,MAPEtestingdesopt),
         nrow=3,ncol=3)
row.names(akurasitestingdes)<- c("SSE", "MSE", "MAPE")
colnames(akurasitestingdes) <- c("des ske1","des ske2","des opt")
akurasitestingdes
```

## Pemulusan Data Musiman

```{r}
#Import data
library(rio)
dataa_mpdw <- import("https://raw.githubusercontent.com/nyayunabila/mpdw/refs/heads/main/Pertemuan%201/data-kelompok-9-mpdw.csv")
dataa_201to300 <- dataa_mpdw[201:300, ]
dataa_201to300
ts_data <- ts(data_201to300$daily_revenue)
```

Pembagian data dan mengubahnya menjadi data deret waktu.

```{r}
#membagi data menjadi training dan testing
training<-dataa_201to300[1:80,2]
testing<-dataa_201to300[81:100,2]
training.ts<-ts(training, frequency = 13)
testing.ts<-ts(testing, frequency = 13)
```

Eskplorasi dengan plot data deret waktu.

```{r}
#Membuat plot time series
plot(ts_data, col="red",main="Plot semua data")
points(ts_data)

plot(training.ts, col="blue",main="Plot data latih")
points(training.ts)

plot(testing.ts, col="green",main="Plot data uji")
points(testing.ts)
```

### Winter Aditif

#### Pemulusan

```{r}
#Pemulusan dengan winter aditif 
winter1 <- HoltWinters(training.ts,alpha=0.2,beta=0.1,gamma=0.1,seasonal = "additive")
winter1$fitted
xhat1 <- winter1$fitted[,2]

winter1.opt<- HoltWinters(training.ts, alpha= NULL,  beta = NULL, gamma = NULL, seasonal = "additive")
winter1.opt
winter1.opt$fitted
xhat1.opt <- winter1.opt$fitted[,2]
```

#### Peramalan

```{r}
#Forecast
forecast1 <- predict(winter1, n.ahead = 20)
forecast1.opt <- predict(winter1.opt, n.ahead = 20)
```

#### Plot Deret Waktu

```{r}
#Plot time series
plot(training.ts,main="Winter 0.2;0.1;0.1",type="l",col="black",
     xlim=c(1,25),pch=12)
lines(xhat1,type="l",col="red")
lines(xhat1.opt,type="l",col="blue")
lines(forecast1,type="l",col="red")
lines(forecast1.opt,type="l",col="blue")
legend("topleft",c("Actual Data",expression(paste(winter1)),
                   expression(paste(winter1.opt))),cex=0.5,
       col=c("black","red","blue"),lty=1)
```

#### Akurasi Data Latih

```{r}
#Akurasi data training
SSE1<-winter1$SSE
MSE1<-winter1$SSE/length(training.ts)
RMSE1<-sqrt(MSE1)
akurasi1 <- matrix(c(SSE1,MSE1,RMSE1))
row.names(akurasi1)<- c("SSE", "MSE", "RMSE")
colnames(akurasi1) <- c("Akurasi")
akurasi1

SSE1.opt<-winter1.opt$SSE
MSE1.opt<-winter1.opt$SSE/length(training.ts)
RMSE1.opt<-sqrt(MSE1.opt)
akurasi1.opt <- matrix(c(SSE1.opt,MSE1.opt,RMSE1.opt))
row.names(akurasi1.opt)<- c("SSE1.opt", "MSE1.opt", "RMSE1.opt")
colnames(akurasi1.opt) <- c("Akurasi")
akurasi1.opt

akurasi1.train = data.frame(Model_Winter = c("Winter 1","Winter1 optimal"),
                            Nilai_SSE=c(SSE1,SSE1.opt),
                            Nilai_MSE=c(MSE1,MSE1.opt),Nilai_RMSE=c(RMSE1,RMSE1.opt))
akurasi1.train
```

#### Akurasi Data Uji

```{r}
#Akurasi Data Testing
forecast1<-data.frame(forecast1)
testing.ts<-data.frame(testing.ts)
selisih1<-forecast1-testing.ts
SSEtesting1<-sum(selisih1^2)
MSEtesting1<-SSEtesting1/length(testing.ts)

forecast1.opt<-data.frame(forecast1.opt)
selisih1.opt<-forecast1.opt-testing.ts
SSEtesting1.opt<-sum(selisih1.opt^2)
MSEtesting1.opt<-SSEtesting1.opt/length(testing.ts)
```

### Winter Multiplikatif

Model multiplikatif digunakan cocok digunakan jika plot data asli menunjukkan fluktuasi musiman yang bervariasi.

#### Pemulusan

```{r}
#Pemulusan dengan winter multiplikatif 
winter2 <- HoltWinters(training.ts,alpha=0.2,beta=0.1,gamma=0.3,seasonal = "multiplicative")
winter2$fitted
xhat2 <- winter2$fitted[,2]

winter2.opt<- HoltWinters(training.ts, alpha= NULL,  beta = NULL, gamma = NULL, seasonal = "multiplicative")
winter2.opt$fitted
xhat2.opt <- winter2.opt$fitted[,2]
```

#### Peramalan

```{r}
#Forecast
forecast2 <- predict(winter2, n.ahead = 20)
forecast2.opt <- predict(winter2.opt, n.ahead = 20)
```

#### Plot Deret Waktu

```{r}
#Plot time series
plot(training.ts,main="Winter 0.2;0.1;0.1",type="l",col="black",
     xlim=c(1,25),pch=12)
lines(xhat2,type="l",col="red")
lines(xhat2.opt,type="l",col="blue")
lines(forecast2,type="l",col="red")
lines(forecast2.opt,type="l",col="blue")
legend("topleft",c("Actual Data",expression(paste(winter2)),
                   expression(paste(winter2.opt))),cex=0.5,
       col=c("black","red","blue"),lty=1)
```

#### Akurasi Data Latih

```{r}
#Akurasi data training
SSE2<-winter2$SSE
MSE2<-winter2$SSE/length(training.ts)
RMSE2<-sqrt(MSE2)
akurasi1 <- matrix(c(SSE2,MSE2,RMSE2))
row.names(akurasi1)<- c("SSE2", "MSE2", "RMSE2")
colnames(akurasi1) <- c("Akurasi lamda=0.2")
akurasi1

SSE2.opt<-winter2.opt$SSE
MSE2.opt<-winter2.opt$SSE/length(training.ts)
RMSE2.opt<-sqrt(MSE2.opt)
akurasi1.opt <- matrix(c(SSE2.opt,MSE2.opt,RMSE2.opt))
row.names(akurasi1.opt)<- c("SSE2.opt", "MSE2.opt", "RMSE2.opt")
colnames(akurasi1.opt) <- c("Akurasi")
akurasi1.opt

akurasi2.train = data.frame(Model_Winter = c("Winter 1","winter2 optimal"),
                            Nilai_SSE=c(SSE2,SSE2.opt),
                            Nilai_MSE=c(MSE2,MSE2.opt),Nilai_RMSE=c(RMSE2,RMSE2.opt))
akurasi2.train
```
model Winter dengan optimasi lebih baik dan lebih cocok dibanding Î»=0.2 manual.
#### Akurasi Data Uji

```{r}
#Akurasi Data Testing
forecast2<-data.frame(forecast2)
testing.ts<-data.frame(testing.ts)
selisih2<-forecast2-testing.ts
SSEtesting2<-sum(selisih2^2)
MSEtesting2<-SSEtesting2/length(testing.ts)

forecast2.opt<-data.frame(forecast2.opt)
selisih2.opt<-forecast2.opt-testing.ts
SSEtesting2.opt<-sum(selisih2.opt^2)
MSEtesting2.opt<-SSEtesting2.opt/length(testing.ts)
```
